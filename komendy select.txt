LAB 5
COMPANY_2025
ZAD 1
-CREATE TABLE `ORDER/CLINT/EMPLOYEE` AS SELECT * FROM company_2025.`ORDER/CLINT/EMPLOYEE`;
-SELECT * FROM `ORDER`;
-SELECT * FROM `ORDER` WHERE ORDER_STATUS LIKE "5";
-SELECT ORDER_ID, ORDER_STATUS FROM `ORDER` WHERE ORDER_ID IN (1,3,5);

ZAD 2
-SELECT * FROM EMPLOYEE WHERE FIRST_NAME LIKE "Agnieszka" AND pensja = "3900";
-SELECT * FROM EMPLOYEE WHERE pensja BETWEEN 5000 and 7000;
-SELECT * FROM CLIENT WHERE FULL_NAME LIKE "%ECO%" AND IS_COMPANY = 1;

ZAD 3
-SELECT * FROM `ORDER` WHERE MONTH(ORDER_DATE) IN (6,7);
-SELECT * FROM `CLIENT` WEHRE TAX_IDENTIFER  IS NOT NULL ORDER BY SHORT_NAME ASC;
-SELECT * FROM `EMPLOYEE` ORDER BY BIRTH_DATE ASC LIMIT 5;

ZAD 4
-SELECT DISTINCT FIRST_NAME FROM EMPLOYEE;
-SELECT CONCAT(FIRST_NAME, '-', LAST_NAME) FROM EMPLOYEE WHERE LAST_NAME LIKE "Ko%";
-SELECT LAST_NAME, pensja FROM EMPLOYEE WHERE DATE_OF_EMPLOYMENT >= '2010-01-01' AND DATE_OF_EMPLOYMENT <= '2015-01-01';

ZAD 5 
-SELECT 
-SELECT * FROM `CLIENT` WHERE TAX_IDENTIFIER IS NULL;
-SELECT SHORT_NAME FROM `CLIENT` WHERE SHORT_NAME LIKE 'K%' OR SHORT_NAME LIKE '%ski' ORDER BY SHORT_NAME DESC;

Wikingowie
ZAD 1 
-CREATE TABLE infs_kowalczuk.kreatura AS SELECT * FROM wikingowie.kreatura;
-SELECT * FROM zasob;
-SELECT * FROM zasob WHERE rodzaj LIKE 'jedzenie';
-SELECT idZasobu, ilosc FROM ekwipunek WHERE in (1,3,5);

ZAD 2
-SELECT * FROM kreatury WHERE rodzaj LIKE "wiedzma" and udzwig >=50;
-SELECT * FROM ZASOB WHERE WAGA BETWEEN '2' AND '5';S

LAB 6
ZAD 1
-SELECT AVG(pensja) FROM EMPLOYEE;
-SELECT AVG(pensja), COUNT(EMPLOYEE_NAME) FROM EMPLOYEE WHERE ORDER BY EMPLOYEE_NAME;
-SELECT AVG(BIRTH_DATE) FROM EMPLOYEE;

ZAD 2
-SELECT DEPARTMENT_ID, SUM(pensja) AS laczna_pensja FROM EMPLOYEE GROUP BY DEPARTMENT_ID ORDER BY laczna_pensja DESC;
-SELECT JOB_POSITION_ID, SUM(pensja) AS laczna_pensja FROM EMPLOYEE GROUP BY JOB_POSITION HAVING AVG(pensja)> 3000 AND COUNT(*) >= 3;
-SELECT DEPARTMENT_ID, COUNT(DISTINCT pensja) AS rozna_pensja, COUNT(*) AS liczba_pracownikow FROM EMPLOYEE GROUP BY DEPARTMENT_ID HAVING COUNT(*) > 4 ORDER BY rozna_pensja ASC;

ZAD 3
-CREATE TABLE `DEPARTMENT/JOB_POSITION` AS SELECT * FROM company_2025.`DEPARTMENT/JOB_POSITION`;
-SELECT DEPARTMENT.DEPARTMENT_NAME, COUNT(EMPLOYEE.EMPLOYEE_NAME) FROM DEPARTMENT LEFT JOIN EMPLOYEE EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID  = EMPLOYEE.DEPARTMENT_ID GROUP BY DEPARTMENT.DEPARTMENT_ID, DEPARTMENT.DEPARTMENT_NAME;
-SELECT 

ZAD 4
-SELECT LAST_NAME, POSITION_NAME FROM EMPLOYEE NATURAL JOIN JOB_POSITION WHERE YEAR(BIRTH_DATE) BETWEEN 1990 AND 1999;
-SELECT LAST_NAME, FIRST_NAME FROM EMPLOYEE JOIN JOB_POSITION USING (JOB_POSITION_ID) WHERE POSITION_NAME = 'Magazynier' ORDER BY BIRTH_DATE DESC LIMIT 5;
-SELECT C1.SHORT_NAME AS klient1, C2.SHORT_NAME AS klient2 FROM CLIENT C1 JOIN CLIENT C2 ON C1.CLIENT_ID + 5 = C2.CLIENT_ID ORDER BY C1.CLIENT_ID;

ZAD 5
-
-


LAB 7
ZAD 1
-SELECT FULL_NAME FROM CLIENT LEFT JOIN `ORDER` ON CLINET.CLIENT_ID = `ORDER`.CLIENT_ID WHERE ORDER_NUMBER IS NULL;
-SELECT UNIT_OF_MEASUREMENT.UNIT_NAME FROM INVENTORY RIGHT JOIN UNIT_OF_MEASUREMENT ON UNIT_OF_MEASUREMENT.UNIT_ID = INVENTORY.UNIT_ID WHERE INVENTORY.UNIT_ID IS NULL;
-SELECT 

ZAD 2
-SELECT DISTINCT DEPARTMENT_NAME FROM `ORDER` JOIN EMPLOYEE ON `ORDER`.EMPLOYEE_ID = EMPLOYEE.EMPLOYEE.NAME JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID;
-SELECT DEPARTMENT_NAME, ORDER_STATUS.STATUS_NAME SUM(ORDER_POSITON.AMOUNT * ORDER_POSITION.SELL_PRICE) AS suma_zamowien from DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID JOIN `ORDER` ON EMPLOYEE.EMPLOYEE_NAME = `ORDER`.EMPLOYEE_ID JOIN ORDER_POSITION ON `ORDER`.ORDER_ID = ORDER_POSITION.ORDER_ID GROUP BY DEPARTMENT.DEPARTMENT_NAME, DEPARTMENT.DEPARTMENT_ID;
-SELECT DEPARTMENT_NAME, ORDER_STATUS.STATUS_NAME, SUM(ORDER_POSITION.AMOUNT * ORDER_POSITION.SELL_PRICE) AS suma_zamówień from DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID JOIN `ORDER` ON EMPLOYEE.EMPLOYEE_NAME = `ORDER`.EMPLOYEE_ID JOIN ORDER_POSITION ON `ORDER`.ORDER_ID = ORDER_POSITION.ORDER_ID JOIN ORDER_STATUS ON `ORDER`.ORDER_STATUS = ORDER_STATUS.STATUS_ID GROUP BY DEPARTMENT.DEPARTMENT_NAME, ORDER_STATUS.STATUS_NAME;

ZAD 3
-SELECT CONCAT(PRODUCT_NAME, '(' ,DESCRIPTION, ')') AS OPIS FROM PRODUCT;
-SELECT CONCAT_WS (',',PRODUCT_ID, CATEGORY_ID, PRODUCT_NAME, PURCHASE_PRICE, DESCRIPTION) AS LISTA FROM PRODUCT;
-SELECT GROUP_CONCAT(CONCAT(EMPLOYEE.FIRST_NAME, ' ',EMPLOYEE.LAST_NAME)SEPARATOR) AS PRACOWNICY FROM DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID GROUP BY DEPARTMENT.DEPARTMENT_ID, DEPARTMENT.DEPARTMENT_NAME;
-SELECT CATEGORY.CATEGORY_NAME, GROUP_CONCAT(PRODUCT.PRODUCT_NAME, ', ') AS nie_sprzedane FROM PRODUCT LEFT JOIN ORDER_POSITION ON PRODUCT.PRODUCT_ID = ORDER_POSITION.PRODUCT_ID JOIN CATEGORY ON PRODUCT.CATEGORY_ID = CATEGORY.CATEGORY_ID WHERE ORDER_POSITION.PRODUCT_ID IS NULL GROUP BY CATEGORY.CATEGORY_ID, CATEGORY.CATEGORY_NAME; 

ZAD 4
-SELECT `ORDER`.ORDER_NUMBER, IF (`ORDER`.ORDER_STATUS IN (3, 4, 7, 10), 'zakonczone' , 'inne') AS status from `ORDER`;
-SELECT PRODUCT.PRODUCT_NAME , CASE WHEN INVENTORY.AMOUNT = 0 WHEN INVENTORY.AMOUNT WHEN INVENTORY.AMOUNT WHEN INVENTORY.AMOUNT
-SELECT CLIENT.CLIENT_ID, IFNULL(CLIENT.TAX_IDENTIFIER, 'KLIENT_INDYWIDUALNY') AS tax FROM CLIENT;

ZAD 5
-SELECT CLIENT_ADDRESS.CITY, SUBSTR(POSTAL_CODE, 1 ,2) AS kody_pocztowe FROM CLIENT_ADDRESS;
-SELECT CITY, GROUP_CONCAT(DISTINCT SUBSTR(POSTAL_CODE, 1, 2)) AS kod_pocztowy FROM CLIENT_ADDRESS GROUP BY CITY;
-SELECT

LAB8 

ZAD 1
- SELECT CLIENT.FULL_NAME, CLIENT_ADDRESS.STREET, LENGTH(CLIENT_ADDRESS.STREET) AS dlugosc, SUBSTR(CLIENT_ADDRESS.STREET, 1 ,5) AS pierwsze_litery From CLIENT JOIN CLIENT_ADDRESS ON CLIENT_ADDRESS.CLIENT_ID = CLIENT.CLIENT_ID;
-SELECT CLIENT.SHORT_NAME, CLIENT_ADDRESS.ADDRESS_TYPE FROM CLIENT LEFT JOIN CLIENT_ADDRESS ON CLIENT.CLIENT_ID = CLIENT_ADDRESS.CLIENT_ID;
-SELECT PRODUCT.PRODUCT_NAME, CATEGORY.CATEGORY_NAME, SUBSTR(PRODUCT.PRODUCT_NAME, 1, 3) AS pierwsze_litery FROM PRODUCT JOIN CATEGORY ON PRODUCT.CATEGORY_ID = CATEGORY.CATEGORY_ID;
- SELECT PRODUCT.PRODUCT_NAME, PRODUCT.DESCRIPTION FROM PRODUCT JOIN ORDER_POSITION ON PRODUCT.PRODUCT_ID = OREDER_POSITION.PRODUCT_ID GROUP BY PRODUCT.PRODUCT_ID, PRODUCT.PRODUCT_NAME, PRODUCT.DESCRIPTION;
ZAD 2
- SELECT CLIENT.FULL_NAME, `ORDER`.ORDER_NUMBER, `ORDER`.ORDER_DATE, DATEDIFF(CURDATE(), `ORDER`.ORDER_DATE) AS dni_od_zamówienia FROM `ORDER` JOIN CLIENT ON `ORDER`.CLIENT_ID = CLIENT.CLIENT_ID;
- SELECT `ORDER`.ORDER_ID, `ORDER`.ORDER_DATE, DATE_ADD(`ORDER`.ORDER_DATE, INTERVAL 14 DAY) AS DNI_ZAPLATY FROM `ORDER` WHERE `ORDER`.ORDER_STATUS NOT IN  (7, 10);
-SELECT EMPLOYEE.FIRST_NAME, EMPLOYEE.LAST_NAME, EMPLOYEE.DATE_OF_EMPLOYMENT, DAYNAME(EMPLOYEE.DATE_OF_EMPLOYMENT) AS dzień_tygodnia, DEPARTMENT.DEPARTMENT_NAME FROM EMPLOYEE LEFT JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID;
- SELECT CLIENT.FULL_NAME, (DATEDIFF(MAX(`ORDER`.ORDER_DATE), MIN(`ORDER`.ORDER_DATE))) AS roznica FROM CLIENT LEFT JOIN `ORDER` ON CLIENT.CLIENT_ID = `ORDER`.CLIENT_ID GROUP BY CLIENT.CLIENT_ID, CLIENT.FULL_NAME;

ZAD 3
- SELECT CLIENT.SHORT_NAME, GROUP_CONCAT(CLIENT_ADDRESS.STREET SEPARATOR ', ') AS lista_adresow FROM CLIENT LEFT JOIN CLIENT_ADDRESS ON CLIENT.CLIENT_ID = CLIENT_ADDRESS.CLIENT_ID GROUP BY CLIENT.CLIENT_ID, CLIENT.SHORT_NAME;
- SELECT CITY, GROUP_CONCAT(DISTINCT SUBSTR(POSTAL_CODE, 1, 2) SEPARATOR ', ') AS prefixy FROM CLIENT_ADDRESS GROUP BY CITY;
- SELECT CONCAT(EMPLOYEE.LAST_NAME, ' ', EMPLOYEE.FIRST_NAME) AS tozsamosc, DEPARTMENT.DEPARTMENT_NAME, DATEDIFF(CURDATE(), EMPLOYEE.DATE_OF_EMPLOYMENT) AS dni_od_zatrudnienia FROM EMPLOYEE LEFT JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_ID;
- SELECT 
- SELECT 

LAB 9

ZAD 1
- SELECT FIRST_NAME, LAST_NAME, pensja RANK() OVER (ORDER BY pensja DESC) AS ranking_wyplat FROM EMPLOYEE;
ZAD 2
- SELECT FIRST_NAME, LAST_NAME, SUM(pensja) OVER () AS suma_wyplat FROM EMPLOYEE;
ZAD 3
- SELECT E.LAST_NAME, P.PRODUCT_NAME, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER (PARTITION BY O.EMPLOYEE_ID) AS suma_wyplat, RANK () OVER (ORDER BY OP.AMOUNT * OP.SELL_PRICE DESC) AS ranking_wyplat FROM ORDER_POSITION OP JOIN 
`ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN EMPLOYEE E ON O.EMPLOYEE_ID = E.EMPLOYEE_NAME JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;
ZAD 4
- Select
ZAD 5
- SELECT P.PRODUCT_NAME, OP.SELL_PRICE, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER (PARTITION BY MONTH(O.ORDER_DATE)) AS miesięczna_suma, SUM(OP.AMOUNT * OP.SELL_PRICE) OVER (PARTITION BY MONTH(O.ORDER_DATE) ORDER BY O.ORDER_DATE) AS suma_przyrostu FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;
ZAD 6
- Select
ZAD 7
- SELECT C.CATEGORY_NAME, P.PRODUCT_NAME, OP.SELL_PRICE, MIN(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) AS minimalna_cena, MAX(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) AS maksymalna_cena, MIN(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) - MAX(OP.SELL_PRICE) OVER (PARTITION BY P.CATEGORY_ID) AS roznica FROM ORDER_POSITION OP JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID JOIN CATEGORY C ON P.CATEGORY_ID = C.CATEGORY_ID;
ZAD 8
- SELECT P.PRODUCT_NAME, AVG(OP.SELL_PRICE) OVER(PARTITION BY P.PRODUCT_ID ORDER BY O.ORDER_DATE ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS zmiana_cen FROM ORDER_POSITION OP JOIN `ORDER` O ON OP.ORDER_ID = O.ORDER_ID JOIN PRODUCT P ON OP.PRODUCT_ID = P.PRODUCT_ID;
ZAD 9
- Select
ZAD 10
-Select
ZAD 11
-SELECT DISTINCT E.FIRST_NAME, E.LAST_NAME, JP.POSITION_NAME FROM EMPLOYEE E JOIN `ORDER` O ON O.EMPLOYEE_ID = E.EMPLOYEE_NAME JOIN JOB_POSITION JP ON E.JOB_POSITION_ID = JP.JOB_POSITION_ID;